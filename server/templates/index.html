{% extends "base.html" %}
{% block title %}–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å{% endblock %}
{% block content %}
<div class="nav">
    <a href="/admin">üìã –í—Å–µ</a>
    <a href="/admin?status=active">‚úÖ –ê–∫—Ç–∏–≤–Ω—ã–µ</a>
    <a href="/admin?status=expired">‚ùå –ü—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–µ</a>
    <a href="/admin/users" class="users">üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</a>
</div>

<h2>‚ûï –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –ª–∏—Ü–µ–Ω–∑–∏—é</h2>
<form class="form-create" method="post" action="/admin/create">
    <label for="telegram_id">Telegram ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</label>
    <input type="text" id="telegram_id" name="telegram_id" required>

    <label for="days">–°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è (–≤ –¥–Ω—è—Ö):</label>
    <input type="number" id="days" name="days" value="30" min="1" required>

    <button type="submit">–°–æ–∑–¥–∞—Ç—å –ª–∏—Ü–µ–Ω–∑–∏—é</button>
</form>

<form method="get" action="/admin">
    <label for="q">–ü–æ–∏—Å–∫:</label>
    <input type="text" id="q" name="q" value="{{ q or '' }}" placeholder="ID –∏–ª–∏ –∫–ª—é—á">

    <label for="status">–°—Ç–∞—Ç—É—Å:</label>
    <select name="status" id="status">
        <option value="" {% if selected_status == "" %}selected{% endif %}>–í—Å–µ</option>
        <option value="active" {% if selected_status == "active" %}selected{% endif %}>–ê–∫—Ç–∏–≤–Ω—ã–µ</option>
        <option value="expired" {% if selected_status == "expired" %}selected{% endif %}>–ü—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–µ</option>
    </select>

    <label for="sort">–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞:</label>
    <select name="sort" id="sort">
        <option value="valid_until_asc" {% if selected_sort == "valid_until_asc" %}selected{% endif %}>–ü–æ —Å—Ä–æ–∫—É ‚Üë</option>
        <option value="valid_until_desc" {% if selected_sort == "valid_until_desc" %}selected{% endif %}>–ü–æ —Å—Ä–æ–∫—É ‚Üì</option>
    </select>

    <button type="submit">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
</form>

    <h1>üîê –õ–∏—Ü–µ–Ω–∑–∏–∏</h1>
<table>
    <tr>
        <th>–ö–ª—é—á</th>
        <th>–î–µ–π—Å—Ç–≤—É–µ—Ç –¥–æ</th>
        <th>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</th>
        <th>–°—Ç–∞—Ç—É—Å</th>
        <th>–î–µ–π—Å—Ç–≤–∏—è</th>
    </tr>
    {% for lic in licenses %}
    <tr>
        <td><code>{{ lic.key }}</code></td>
        <td>{{ lic.valid_until }}</td>
        <td>{{ lic.user_id }}</td>
        <td class="{{ 'status-active' if '–ê–∫—Ç–∏–≤–Ω–∞' in lic.status else 'status-expired' }}">{{ lic.status }}</td>
        <td>
            <form method="post" action="/admin/delete" class="inline-form" onsubmit="return confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç—É –ª–∏—Ü–µ–Ω–∑–∏—é?');">
                <input type="hidden" name="license_key" value="{{ lic.key }}">
                <button type="submit">üóë</button>
            </form>

                  <form method="post" action="/admin/reduce" class="inline-form" onsubmit="return confirm('–£–º–µ–Ω—å—à–∏—Ç—å —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è —ç—Ç–æ–π –ª–∏—Ü–µ–Ω–∑–∏–∏ –Ω–∞ 30 –¥–Ω–µ–π?');">
                <input type="hidden" name="license_key" value="{{ lic.key }}">
                <button type="submit">‚ûñ 30 –¥–Ω.</button>
            </form>

                <form method="post" action="/admin/extend" class="inline-form">
                <input type="hidden" name="license_key" value="{{ lic.key }}">
                <button type="submit">‚ûï 30 –¥–Ω.</button>
            </form>
        </td>
    </tr>
    {% endfor %}
</table>
{% endblock %}
